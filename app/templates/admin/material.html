<!--
người chỉnh sửa: Nguyễn Thái Nguyên
thời gian chỉnh sửa: 17/01/2025
nội dung: trang quản lý chất liệu
-->

<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chất Liệu | Jewelry Store Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="min-h-screen bg-slate-50 text-slate-800">
    <div class="flex min-h-screen">

      <!-- ASIDE -->
      {% include "layout_admin/aside_dashboard.html" %}

      <!-- MAIN -->
      <div class="flex flex-1 flex-col">

        <!-- HEADER -->
        <header
          class="flex flex-wrap items-center justify-between gap-4 border-b border-slate-200 bg-white px-6 py-4"
        >
          <div>
            <a href="{{ url_for('material.show_all_material') }}">
              <h1 class="text-xl font-semibold text-slate-900 hover:text-rose-500 transition">
                QUẢN LÝ CHẤT LIỆU
              </h1>
            </a>
            <p class="text-sm text-slate-500">
              Thêm, sửa, xoá, tra cứu chất liệu
            </p>
          </div>

          <div class="flex flex-1 flex-wrap items-center justify-end gap-3">
            <!-- SEARCH -->
            <form method="get" class="relative w-full max-w-xs">
              <input
                type="search"
                name="keyword"
                placeholder="Tìm tên hoặc mã chất liệu..."
                value="{{ request.args.get('keyword','') }}"
                class="w-full rounded-lg border border-slate-200 bg-slate-50 py-2 pl-10 pr-3 text-sm"
              />
              <svg
                class="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"
                viewBox="0 0 24 24"
                fill="none"
              >
                <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="1.6"/>
                <path d="m20 20-3.5-3.5" stroke="currentColor" stroke-width="1.6"/>
              </svg>
            </form>

            <a
              href="{{ url_for('material.create_material') }}"
              class="rounded-lg bg-rose-500 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-600"
            >
              Thêm chất liệu
            </a>
          </div>
        </header>

        <!-- CONTENT -->
        <main class="flex-1 space-y-6 px-6 py-6">

          <!-- THỐNG KÊ -->
          <section class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
            <div class="rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-100">
              <p class="text-sm text-slate-500">Tổng chất liệu</p>
              <p class="mt-2 text-2xl font-semibold text-slate-900">
                {{ total_materials }}
              </p>
            </div>
          </section>

          <!-- DANH SÁCH -->
          <section class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-slate-100">

            <h2 class="text-base font-semibold text-slate-900">
              Danh sách chất liệu
            </h2>

            <!-- TABLE -->
            <div class="mt-4 overflow-x-auto">
              <table class="min-w-full text-sm">
                <thead class="text-left text-xs uppercase text-slate-400">
                  <tr>
                    <th class="pb-3">Mã chất liệu</th>
                    <th class="pb-3">Tên chất liệu</th>
                    <th class="pb-3">Hành động</th>
                  </tr>
                </thead>

                <tbody class="text-slate-600">
                  {% if materials %}
                    {% for m in materials %}
                    <tr class="border-b">
                      <td class="py-3">{{ m.ma_chat_lieu }}</td>
                      <td class="py-3 font-medium text-slate-900">
                        {{ m.ten_chat_lieu }}
                      </td>
                      <td class="py-3">
                        <a
                          href="{{ url_for('material.edit_material', id=m.ma_chat_lieu) }}"
                          class="rounded-lg border border-blue-200 px-3 py-1.5 text-xs text-blue-600 hover:bg-blue-50"
                        >Sửa</a>

                        <form
                          method="post"
                          action="{{ url_for('material.delete_material', id=m.ma_chat_lieu) }}"
                          class="inline"
                          onsubmit="return confirm('Xoá chất liệu này?');"
                        >
                          <button
                            class="rounded-lg border border-rose-200 px-3 py-1.5 text-xs text-rose-600 hover:bg-rose-50"
                          >Xoá</button>
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="3" class="py-6 text-center text-slate-400">
                        Chưa có chất liệu nào.
                      </td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>

            <!-- PAGINATION -->
            <div class="mt-4 flex justify-between text-sm text-slate-600">
              <p>
                Hiển thị từ
                {{ pagination.page*pagination.per_page - pagination.per_page + 1 }}
                -
                {{ pagination.page*pagination.per_page if pagination.page*pagination.per_page < pagination.total else pagination.total }}
                trong {{ pagination.total }} chất liệu
              </p>

              <div class="flex gap-1">
                {% if pagination.has_prev %}
                <a
                  href="{{ url_for('material.show_all_material', page=pagination.prev_num, keyword=request.args.get('keyword')) }}"
                  class="rounded-lg border px-3 py-1.5"
                >Trước</a>
                {% endif %}

                {% for p in pagination.iter_pages(left_edge=1,right_edge=1,left_current=1,right_current=1) %}
                  {% if p %}
                    {% if p==pagination.page %}
                      <span class="rounded-lg bg-rose-500 px-3 py-1.5 text-white">{{p}}</span>
                    {% else %}
                      <a
                        href="{{ url_for('material.show_all_material', page=p, keyword=request.args.get('keyword')) }}"
                        class="rounded-lg border px-3 py-1.5"
                      >{{p}}</a>
                    {% endif %}
                  {% else %}
                    <span class="px-2">…</span>
                  {% endif %}
                {% endfor %}

                {% if pagination.has_next %}
                <a
                  href="{{ url_for('material.show_all_material', page=pagination.next_num, keyword=request.args.get('keyword')) }}"
                  class="rounded-lg border px-3 py-1.5"
                >Sau</a>
                {% endif %}
              </div>
            </div>

          </section>
        </main>
      </div>
    </div>
  </body>
</html>
