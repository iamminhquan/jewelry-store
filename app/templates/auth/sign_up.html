{% extends "base.html" %}

{% block title %}Đăng ký{% endblock %}

{% block content %}
<div class="mx-auto flex min-h-[70vh] w-full max-w-5xl items-center justify-center py-8">
  <div class="grid w-full items-center gap-10 lg:grid-cols-2">
    <section class="order-2 rounded-2xl bg-white p-8 shadow-lg ring-1 ring-rose-100 lg:order-1">
      <div>
        <h2 class="text-2xl font-semibold text-slate-900">Tạo tài khoản</h2>
        <p class="mt-2 text-sm text-slate-600">Gia nhập cộng đồng yêu trang sức ngay hôm nay.</p>
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mt-4 space-y-2 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-700">
            {% for category, message in messages %}
              <p>{{ message }}</p>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <form class="mt-6 space-y-5" action="{{ url_for('auth.show_sign_up_page') }}" method="post">
        <div>
          <label for="username" class="text-sm font-medium text-slate-700">Tên đăng nhập</label>
          <div class="mt-2">
            <input id="username" name="username" type="text" autocomplete="username" placeholder="Tên đăng nhập"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
          </div>
        </div>

        <div>
          <label for="full-name" class="text-sm font-medium text-slate-700">Họ và tên</label>
          <div class="mt-2">
            <input id="full-name" name="full_name" type="text" autocomplete="name" placeholder="Nhập tên của bạn"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
          </div>
        </div>

        <div>
          <label for="email" class="text-sm font-medium text-slate-700">Email</label>
          <div class="mt-2">
            <input id="email" name="email" type="email" autocomplete="email" placeholder="Nhập email của bạn"
              pattern="^[A-Za-z0-9._%+-]+@(gmail|hotmail|yahoo|outlook)\.com(\.vn)?$"
              title="Email phải thuộc gmail, hotmail, yahoo hoặc outlook (ví dụ: ten@gmail.com)"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
          </div>
        </div>

        <div>
          <label for="phone" class="text-sm font-medium text-slate-700">Số điện thoại</label>
          <div class="mt-2">
            <input id="phone" name="phone" type="tel" autocomplete="tel" placeholder="09xxxxxxxx"
              pattern="^(0|\+84)[0-9]{9,10}$" title="Số điện thoại hợp lệ (bắt đầu bằng 0 hoặc +84)"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
          </div>
        </div>

        <div>
          <label for="password" class="text-sm font-medium text-slate-700">Mật khẩu</label>
          <div class="relative mt-2">
            <input id="password" name="password" type="password" autocomplete="new-password"
              placeholder="Nhập mật khẩu" pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{8,}"
              title="Tối thiểu 8 ký tự, gồm chữ hoa, chữ thường, số và ký tự đặc biệt"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 pr-11 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
            <button type="button" id="toggle-password" aria-label="Hiện mật khẩu"
              class="absolute right-3 top-1/2 -translate-y-1/2 rounded-full p-1 text-rose-500 transition hover:bg-rose-100/70">
              <svg id="icon-eye" class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M2.5 12s3.6-6.5 9.5-6.5 9.5 6.5 9.5 6.5-3.6 6.5-9.5 6.5S2.5 12 2.5 12Z"
                  stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <circle cx="12" cy="12" r="3.2" stroke="currentColor" stroke-width="1.6" />
              </svg>
              <svg id="icon-eye-off" class="hidden h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M3.5 5.5 20.5 18.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
                <path
                  d="M10.4 6.3A9.6 9.6 0 0 1 12 6c5.9 0 9.5 6 9.5 6a15.3 15.3 0 0 1-4.5 4.9M6.6 8.1A15.6 15.6 0 0 0 2.5 12s3.6 6 9.5 6a9.7 9.7 0 0 0 4.3-1"
                  stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M9.8 9.8a3.2 3.2 0 0 0 4.4 4.4" stroke="currentColor" stroke-width="1.6"
                  stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
          </div>
        </div>

        <div>
          <label for="confirm-password" class="text-sm font-medium text-slate-700">Xác nhận mật khẩu</label>
          <div class="relative mt-2">
            <input id="confirm-password" name="confirm_password" type="password" autocomplete="new-password"
              placeholder="Nhập lại mật khẩu"
              class="w-full rounded-lg border border-rose-200 bg-rose-50/60 px-4 py-2.5 pr-11 text-sm text-slate-800 outline-none transition focus:border-rose-400 focus:ring-2 focus:ring-rose-100"
              required />
            <button type="button" id="toggle-confirm-password" aria-label="Hiện mật khẩu xác nhận"
              class="absolute right-3 top-1/2 -translate-y-1/2 rounded-full p-1 text-rose-500 transition hover:bg-rose-100/70">
              <svg id="icon-eye-confirm" class="h-5 w-5" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M2.5 12s3.6-6.5 9.5-6.5 9.5 6.5 9.5 6.5-3.6 6.5-9.5 6.5S2.5 12 2.5 12Z"
                  stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <circle cx="12" cy="12" r="3.2" stroke="currentColor" stroke-width="1.6" />
              </svg>
              <svg id="icon-eye-off-confirm" class="hidden h-5 w-5" viewBox="0 0 24 24" fill="none"
                aria-hidden="true">
                <path d="M3.5 5.5 20.5 18.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
                <path
                  d="M10.4 6.3A9.6 9.6 0 0 1 12 6c5.9 0 9.5 6 9.5 6a15.3 15.3 0 0 1-4.5 4.9M6.6 8.1A15.6 15.6 0 0 0 2.5 12s3.6 6 9.5 6a9.7 9.7 0 0 0 4.3-1"
                  stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M9.8 9.8a3.2 3.2 0 0 0 4.4 4.4" stroke="currentColor" stroke-width="1.6"
                  stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
          </div>
        </div>

        <label class="flex items-center gap-2 text-sm text-slate-600">
          <input type="checkbox" class="h-4 w-4 rounded border-rose-300 text-rose-500 focus:ring-rose-400" required />
          Tôi đồng ý với điều khoản sử dụng
        </label>

        <button type="submit"
          class="w-full rounded-lg bg-rose-500 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-rose-600 focus:outline-none focus:ring-2 focus:ring-rose-300">
          Tạo tài khoản
        </button>
      </form>

      <p class="mt-6 text-center text-sm text-slate-600">
        Đã có tài khoản?
        <a href="{{ url_for('auth.show_sign_in_page') }}" class="font-semibold text-rose-600 hover:text-rose-500">Đăng
          nhập</a>
      </p>
    </section>

    <div class="order-1 hidden lg:block lg:order-2">
      <p class="text-sm font-semibold uppercase tracking-[0.3em] text-rose-500">Bắt đầu ngay</p>
      <h1 class="mt-4 text-4xl font-semibold text-slate-900">Tạo tài khoản trong vài phút</h1>
      <p class="mt-4 text-base text-slate-600">Lưu đơn hàng, theo dõi vận chuyển và nhận ưu đãi thành viên.</p>
      <div class="mt-6 space-y-3 text-sm text-slate-500">
        <div class="flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-rose-500"></span>
          Bộ sưu tập mới mỗi tuần
        </div>
        <div class="flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-rose-500"></span>
          Hỗ trợ tư vấn phong cách
        </div>
        <div class="flex items-center gap-2">
          <span class="h-2 w-2 rounded-full bg-rose-500"></span>
          Ưu đãi dành riêng cho thành viên
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const togglePassword = document.getElementById("toggle-password");
  const passwordInput = document.getElementById("password");
  const iconEye = document.getElementById("icon-eye");
  const iconEyeOff = document.getElementById("icon-eye-off");

  const toggleConfirm = document.getElementById("toggle-confirm-password");
  const confirmInput = document.getElementById("confirm-password");
  const iconEyeConfirm = document.getElementById("icon-eye-confirm");
  const iconEyeOffConfirm = document.getElementById("icon-eye-off-confirm");

  togglePassword?.addEventListener("click", () => {
    const isHidden = passwordInput.type === "password";
    passwordInput.type = isHidden ? "text" : "password";
    iconEye.classList.toggle("hidden", !isHidden);
    iconEyeOff.classList.toggle("hidden", isHidden);
    togglePassword.setAttribute("aria-label", isHidden ? "Ẩn mật khẩu" : "Hiện mật khẩu");
  });

  toggleConfirm?.addEventListener("click", () => {
    const isHidden = confirmInput.type === "password";
    confirmInput.type = isHidden ? "text" : "password";
    iconEyeConfirm.classList.toggle("hidden", !isHidden);
    iconEyeOffConfirm.classList.toggle("hidden", isHidden);
    toggleConfirm.setAttribute(
      "aria-label",
      isHidden ? "Ẩn mật khẩu xác nhận" : "Hiện mật khẩu xác nhận"
    );
  });
</script>
{% endblock %}